name: Team Intro

on:
  workflow_dispatch:
    inputs:
      reset:
        description: 'Reset README before running?'
        type: boolean
        default: true

permissions:
  contents: write

jobs:
  reset:
    if: ${{ inputs.reset == true }}
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          ref: main
      - name: Recreate demo branch from main
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git checkout -B demo
          git push origin demo --force

  who-i-am:
    needs: [reset]
    if: always() && !failure() && !cancelled()
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          ref: demo
      - name: Pull latest
        run: git pull origin demo
      - name: Update README
        run: |
          cat >> README.md << 'EOF'
          # Hi, I'm Jash!
          ### Software Engineer 2 — GitHub Actions Compute & Storage
          > Here to build things that make developers faster.
          - Redmond, WA
          - MS Computer Science — Arizona State University
          - Fun fact: I am a huge Formula 1 fan and love to do Karting!
          EOF
      - name: Commit and push
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add README.md
          git commit -m "intro: add who-i-am"
          git push

  my-journey:
    needs: [who-i-am]
    if: always() && !failure() && !cancelled()
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          ref: demo
      - name: Pull latest
        run: git pull origin demo
      - name: Update README
        run: |
          cat >> README.md << 'EOF'
          ---
          ## My Journey
          - **LEAPS Lab @ ASU** — Built backend for power systems optimizations and led AI initiatives
          - **Microsoft DevBox** — Joined Dec 2025
          - **GitHub Actions C&S** — Came over with the team during the reorg
          EOF
      - name: Commit and push
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add README.md
          git commit -m "intro: add my-journey"
          git push

  what-ive-shipped:
    needs: [my-journey]
    if: always() && !failure() && !cancelled()
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          ref: demo
      - name: Pull latest
        run: git pull origin demo
      - name: Update README
        run: |
          cat >> README.md << 'EOF'
          ---
          ## What I've Shipped (under 2 months in)
          - Runner pool image editing
          - Snapshot versioning
          - Feature flag cleanup
          - 22 PRs merged across 9 repos
          EOF
      - name: Commit and push
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add README.md
          git commit -m "intro: add what-ive-shipped"
          git push

  what-excites-me:
    needs: [what-ive-shipped]
    if: always() && !failure() && !cancelled()
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          ref: demo
      - name: Pull latest
        run: git pull origin demo
      - name: Update README
        run: |
          cat >> README.md << 'EOF'
          ---
          ## What Excites Me
          - Infrastructure at scale
          - Developer Experience
          - Learning the full compute pipeline
          - This team — excited to build with everyone
          ---
          *This README was built live by a GitHub Actions workflow.*
          EOF
      - name: Commit and push
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git add README.md
          git commit -m "intro: add what-excites-me"
          git push
      - name: Write Job Summary
        run: |
          echo "# Hello, Actions Team — I'm Jash!" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "Built with GitHub Actions, naturally." >> $GITHUB_STEP_SUMMARY